<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="config.MemberMapper">
	<resultMap id="MemberMap" type="domain.Member">
		<id		property="memberID"		column="MEMBER_ID"/>
		<result	property="email"		column="EMAIL"/>
		<result property="password"		column="PASSWD"/>
		<result property="name"			column="NAME"/>
		<result property="postCode"		column="POSTCODE"/>
		<result property="address"		column="ADDRESS"/>
		<result property="phone"		column="PHONE"/>
		<result property="bonusPoint"	column="BONUS_POINT"/>
	</resultMap>
	
	<select id="getMembers" resultMap="MemberMap">
		select * from members 
		order by member_id
	</select>
	
	<select id="getMember" parameterType="int" resultMap="MemberMap">
		select * from members
		where MEMBER_ID =#{memberID}
	</select>
	
	<select id="loginCheck" parameterType="domain.Member" resultMap="MemberMap">
		select member_id, email, passwd
		from members
		where (email=#{email} and PASSWD=#{password})
	</select>
	
	<insert id="addMember" parameterType="domain.Member">
		insert into members(member_id, email, PASSWD, name, POSTCODE, address, phone)
		values(member_id_seq.nextval, #{email,jdbcType=VARCHAR}, #{password,jdbcType=VARCHAR}, 
									  #{name,jdbcType=VARCHAR}, #{postCode,jdbcType=NUMERIC}, 
									  #{address,jdbcType=VARCHAR}, #{phone,jdbcType=VARCHAR})
	</insert>
	
	<select id="findIdMember" parameterType="domain.Member" resultMap="MemberMap">
		select email
		from members
		where name = #{name} and phone = #{phone}
	</select>
	
	<select id="findPwMember" parameterType="domain.Member" resultMap="MemberMap">
		select passwd
		from members 
		where email = #{email} and name = #{name} and phone = #{phone}
	</select>
	
	<update id="updatePoint" parameterType="domain.Member">
		update members 
		set bonus_point = #{bonusPoint}
		where member_id = #{memberID}
	</update>
	
	<delete id="delMember" parameterType="domain.Member">
		delete from members
		where member_id=#{memberID}
	</delete>
	
	<select id="idCheck" parameterType="domain.Member" resultType="boolean">
		select count(*)
		from members
		where email = #{email}
	</select>

	<delete id="getoutMember" parameterType="domain.Member">
		delete from members
		where PASSWD=#{password}
	</delete>
</mapper>
